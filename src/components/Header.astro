---
import HeaderLink from './HeaderLink.astro';
import { TOP_LEVEL_LINKS } from '../consts';
import { Image } from 'astro:assets';
import siteBanner from '../assets/codesandchats_banner.png';


---

<header>

    <nav class="sm:justify-between justify-between w-full">
        <button id="mobile-show-sidebar" class="button sm:hidden transition-opacity mb-6 ml-5 mr-10" style="z-index: 33">
        <div class="inline-block cursor-pointer fixed">
          <div class="w-7 h-1 bg-gray-600 mt-1 rounded-lg"></div>
          <div class="w-7 h-1 bg-gray-600 mt-1 rounded-lg"></div>
          <div class="w-7 h-1 bg-gray-600 mt-1 rounded-lg"></div>
        </div>
        </button>

        <h2><a href="/"><Image class="mr-auto" width="200" src={siteBanner} alt="codes&chats banner"/></a></h2>
		<div class="internal-links hidden sm:block">
		{TOP_LEVEL_LINKS.map(link => (<HeaderLink href={link.href}>{link.name}</HeaderLink>))}
		</div>
        <div class="flex flex-col right-0 sm:ml-[7em]" >
    <input type="checkbox" id="light-switch" name="light-switch" class="light-switch sr-only" />
    <label class="relative cursor-pointer p-2" for="light-switch">
        <svg fill="currentColor" viewBox="50 50 412 412" id="lightmode-icon" width="32" height="32" xmlns="http://www.w3.org/2000/svg">
             <g><g><path fill="currentColor" d="M256,144c-61.75,0-112,50.25-112,112s50.25,112,112,112s112-50.25,112-112S317.75,144,256,144z M256,336    c-44.188,0-80-35.812-80-80c0-44.188,35.812-80,80-80c44.188,0,80,35.812,80,80C336,300.188,300.188,336,256,336z M256,112    c8.833,0,16-7.167,16-16V64c0-8.833-7.167-16-16-16s-16,7.167-16,16v32C240,104.833,247.167,112,256,112z M256,400    c-8.833,0-16,7.167-16,16v32c0,8.833,7.167,16,16,16s16-7.167,16-16v-32C272,407.167,264.833,400,256,400z M380.438,154.167    l22.625-22.625c6.25-6.25,6.25-16.375,0-22.625s-16.375-6.25-22.625,0l-22.625,22.625c-6.25,6.25-6.25,16.375,0,22.625    S374.188,160.417,380.438,154.167z M131.562,357.834l-22.625,22.625c-6.25,6.249-6.25,16.374,0,22.624s16.375,6.25,22.625,0    l22.625-22.624c6.25-6.271,6.25-16.376,0-22.625C147.938,351.583,137.812,351.562,131.562,357.834z M112,256    c0-8.833-7.167-16-16-16H64c-8.833,0-16,7.167-16,16s7.167,16,16,16h32C104.833,272,112,264.833,112,256z M448,240h-32    c-8.833,0-16,7.167-16,16s7.167,16,16,16h32c8.833,0,16-7.167,16-16S456.833,240,448,240z M131.541,154.167    c6.251,6.25,16.376,6.25,22.625,0c6.251-6.25,6.251-16.375,0-22.625l-22.625-22.625c-6.25-6.25-16.374-6.25-22.625,0    c-6.25,6.25-6.25,16.375,0,22.625L131.541,154.167z M380.459,357.812c-6.271-6.25-16.376-6.25-22.625,0    c-6.251,6.25-6.271,16.375,0,22.625l22.625,22.625c6.249,6.25,16.374,6.25,22.624,0s6.25-16.375,0-22.625L380.459,357.812z" fill="#1D1D1B"/></g></g>
        </svg>
        <svg viewBox="100 100 312 312" id="darkmode-icon" width="32" height="32" xmlns="http://www.w3.org/2000/svg">
            <path fill="currentColor" d="M349.852,343.15c-49.875,49.916-131.083,49.916-181,0c-49.916-49.918-49.916-131.125,0-181.021  c13.209-13.187,29.312-23.25,47.832-29.812c5.834-2.042,12.293-0.562,16.625,3.792c4.376,4.375,5.855,10.833,3.793,16.625  c-12.542,35.375-4,73.666,22.25,99.917c26.209,26.228,64.5,34.75,99.916,22.25c5.792-2.062,12.271-0.582,16.625,3.793  c4.376,4.332,5.834,10.812,3.771,16.625C373.143,313.838,363.06,329.941,349.852,343.15z M191.477,184.754  c-37.438,37.438-37.438,98.354,0,135.771c40,40.021,108.125,36.416,143-8.168c-35.959,2.25-71.375-10.729-97.75-37.084  c-26.375-26.354-39.333-61.771-37.084-97.729C196.769,179.796,194.039,182.192,191.477,184.754z" fill="#1D1D1B"/>
        </svg>
        <span class="sr-only">Switch to light / dark version</span>
    </label>
</div>
	</nav>
        <div class="navbar-spacer"></div>
        <div id="slide-over" class="fixed bg-white left-0 z-30 sm:w-64 w-full h-screen transition-transform -translate-x-full sm:translate-x-0 shadow-md sm:hidden">
            <div class="grid place-items-center text-center">
                 <button id="slide-over-close-btn" type="button" class="top-2.5 sm:invisible text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 absolute right-2.5 inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white" >
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                    <span class="sr-only">Close menu</span>
                </button>

                <ul class="mt-2">
                    {TOP_LEVEL_LINKS.map(link =>
                        (<li><a class="w-full font-medium hover:underline" href={link.href}>{link.name}</a></li>))
                    }
                </ul>
            </div>
        </div>
        <script>
        function handleSlideOver()
            {
                let elem = document.getElementById('slide-over') as any;
                let showBtn = document.getElementById("mobile-show-sidebar") as any;
                if(elem !== undefined && showBtn !== undefined){
                    elem.classList.toggle("-translate-x-full");
                    showBtn.classList.toggle("opacity-0"); 
                    showBtn.disabled = !showBtn.disabled;
                }
            }

        function handleThemeChange(){
            let theme = document.documentElement.getAttribute("data-theme");
            console.log("HIII", theme);
            if (theme == "dark"){
                document.documentElement.setAttribute("data-theme", "light");
                sessionStorage.setItem('data-theme', "light");
            }else{
                document.documentElement.setAttribute("data-theme", "dark");
                sessionStorage.setItem('data-theme', "dark");
            }
        }
        function getPreferredColorScheme() {
          if (sessionStorage.getItem("data-theme")){
              return sessionStorage.getItem("data-theme") || "light";
          }
          if (window.matchMedia) {
            if(window.matchMedia('(prefers-color-scheme: dark)').matches){
              return 'dark';
            } else {
              return 'light';
            }
          }
          return 'light';
        }
        document.documentElement.setAttribute("data-theme", getPreferredColorScheme());
        document.getElementById("light-switch")?.addEventListener("click", handleThemeChange);
        document.getElementById("mobile-show-sidebar")?.addEventListener("click", handleSlideOver);
        document.getElementById("slide-over-close-btn")?.addEventListener("click", handleSlideOver);
        </script>

</header>
<style>
    #lightmode-icon {
        display: var(--lightmode-toggle);
    }
    #darkmode-icon {
        display: var(--darkmode-toggle);
    }

    #slide-over {
        background: rgb(var(--nav-color));
    }
    .navbar-spacer {
        height: 64px;
        background: rgb(var(--nav-color));
    }
    @media (min-width: 640px) {
        .navbar-spacer {
            height: 77px;
        }
    }
	header {
		margin: 0;
		padding: 0 1em;
		background: rgb(var(--nav-color));
		box-shadow: 0 2px 8px rgba(var(--black), 5%);
	}
	h2 {
		margin: 0;
		font-size: 1em;
	}

	h2 a,
	h2 a.active {
		text-decoration: none;
	}
	nav {
        top: 0;
        left: 0;
        width: 100%;
        padding-left: 1.25%;
        padding-right: 1.25%;
		display: flex;
        position: fixed;
        background: rgb(var(--nav-color));
        color: rgb(var(--black));
		align-items: center;
	}
	nav a {
		padding: 1em 0.5em;
		color: var(--black);
		border-bottom: 4px solid transparent;
		text-decoration: none;
	}
	nav a.active {
		text-decoration: none;
		border-bottom-color: var(--accent);
	}
	.social-links,
	.social-links a {
		display: flex;
	}
	@media (max-width: 720px) {
		.social-links {
			display: none;
		}
	}
</style>
